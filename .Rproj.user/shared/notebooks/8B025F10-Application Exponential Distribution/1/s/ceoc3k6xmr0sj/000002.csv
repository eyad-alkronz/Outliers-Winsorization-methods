"0","getmode <- function(v) {"
"0","  "
"0","  x<-v"
"0","  lim.inf=min(x)-1; lim.sup=max(x)+1"
"0","  "
"0","  # hist(x,freq=FALSE,breaks=seq(lim.inf,lim.sup,0.2))"
"0","  s<-density(x,from=lim.inf,to=lim.sup,bw=0.2)"
"0","  n<-length(s$y)"
"0","  v1<-s$y[1:(n-2)];"
"0","  v2<-s$y[2:(n-1)];"
"0","  v3<-s$y[3:n]"
"0","  ix<-1+which((v1<v2)&(v2>v3))"
"0","  "
"0","  #lines(s$x,s$y,col=""red"")"
"0","  #points(s$x[ix],s$y[ix],col=""blue"")"
"0","  "
"0","  md <- s$x[which(s$y==max(s$y))] "
"0","  "
"0","  md"
"0","}"
"0",""
